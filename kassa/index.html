<!DOCTYPE html>
<html lang="en">
<head>
    <title>PyroDesk</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="/assets/js/myscripts.js"></script>


</head>
<body>

<!--header-->
<nav class="navbar navbar-light justify-content-between" >
    <a class="navbar-brand" href="#" style="position: absolute; left: 0;">
        <img src="assets/images/PyroDesk.png" width="200" height="50" alt="">
    </a>
    <div class="col-12 logOutBtn">
        <i class="fa  fa-sign-out-alt"></i> Log Out
    </div>
</nav>
<!--header-->


<div class="container-fluid">
    <div class="row">
        <div class="col-8 shoppingSection">
            <!--toggle bar-->
            <div class="row">
                <div class="col-12 toggleBar">
                    <button id="toggleBtn" onclick="toggle()">Keyboard View</button>
                </div>
            </div>
            <!--/toggle bar-->

            <div class="row touchViewSection">
                <!--shopping sector-->
                <!-- touchView -->
                <!-- Categories menu -->
                <div class="col-3 categoriesSection"> Categories
                    <div class="categories">
                        <a class="nav-link" >All</a>
                        <a class="nav-link" >Black-thunder</a>
                        <a class="nav-link" >Blue-eagle-fireworks</a>
                        <a class="nav-link" >Crystal-exclusive</a>
                        <a class="nav-link" >Empire-fireworks</a>
                        <a class="nav-link" >Grondbloemen</a>
                        <a class="nav-link" >Happy Crackers</a>
                        <a class="nav-link" >Knalerwten</a>
                        <a class="nav-link" >Mad-dog</a>
                        <a class="nav-link" >Knalerwten</a>
                        <a class="nav-link" >Red-dragon</a>
                        <a class="nav-link" >Vuurwerktoppers</a>
                        <a class="nav-link" >Overige artikelen</a>


                    </div>
                </div>
                <div class="col-3"></div>
                <!-- categories menu -->
                <div class="col-9 productItems" >
                    <br>
                    <div class="row" id="touchViewProducts">
                    </div>
                </div>
            </div>
            <!--/touchView -->
            <!--Keyboard View -->
            <div class="row keyboardViewSection">
                <div class="col-12 keyboardViewRow">
                    <div class="col-12 searchBar">
                        <input class="form-control" id="search" type="text" name="search" placeholder="search">
                    </div>
                    <table class="table table-hover">
                        <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Product Name</th>
                            <th scope="col">Free Stock</th>
                            <th scope="col">Price</th>
                            <th scope="col">Actions</th>
                        </tr>
                        </thead>
                        <tbody id="productTable">
                        <tr>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!--/Keyboard View -->
            <div class="footer">
                <div class="container">
                    <p class="text-muted"> Developed by Vesta Group</p>
                </div>
            </div>
        </div>
        <!--/shopping sector-->
        <div class="col-4 cartSection">
            <!--cart-->
            <div class="row">
                <div class="col-5">Product</div>
                <div class="col-1">Pcs.</div>
                <div class="col-2">Price</div>
                <div class="col-3">Total</div>
            </div>

            <hr style="background-color: white;">

            <div class="row" id="output">

            </div>


            <div class="row cartCheck">

                <div class="col-5">Numbers of products</div>
                <div class="col-1">1</div>
                <div class="col-2">Subtotal</div>
                <div class="col-3 total">&euro; 0,00</div>

                <div class="col-5"></div>
                <div class="col-1"></div>
                <div class="col-2">Total </div>
                <div class="col-3">&euro; 0,00</div>

                <div class="col-12 checkoutBtn"> Checkout </div>
                <div class="col-6 addDiscountBtn"> Add discount </div>
                <div class="col-6 cancelBtn"> Cancel </div>
            </div>
            <!--/cart-->
        </div>
    </div>
</div>

</div>
    <script>
        var shoppingCart = [];
        $(document).ready(function() {
            //
            outputShoppingCart();
            $(".productItem").click(function(e){
                e.preventDefault();
                var itemInfo = $(this.dataset)[0];
                itemInfo.qty = 1;
                var itemInCart = false;
                $.each(shoppingCart,function(index,value){
                    // console.log(index + ' ' + value.id);
                    if(value.id == itemInfo.id){
                        value.qty = parseInt(value.qty) + parseInt(itemInfo.qty);
                        itemInCart = true;
                    }
                })
                if(!itemInCart){
                    shoppingCart.push(itemInfo);
                }
                sessionStorage["sc"]= JSON.stringify(shoppingCart)
                outputShoppingCart();
                ///
            })

            //add to shopping cart function
            function outputShoppingCart(){
                if(sessionStorage["sc"] != null){
                    shoppingCart = JSON.parse(sessionStorage["sc"].toString());
                }
                var holderHTML = "";
                var total = 0;
                $.each(shoppingCart,function(index,value){
                    // console.log(value);
                    var stotal = value.qty * value.price;
                    var totalCount =
                    total += stotal;
                    holderHTML = holderHTML + '<div class="col-5">' + value.name  + '</div>' +
                                              '<div class="col-1">' + value.qty   + '</div>' +
                                              '<div class="col-2">' + formatMoney(value.price) + '</div>' +
                                              '<div class="col-3">' + formatMoney(stotal) + '</div>'
                })
                $('.total').html(formatMoney(total));
                $('#output').html(holderHTML);
            }
    //search function
            $('.searchBar').keyup(function(){
                $('#productTable').html('');
                var searchField = $('.searchBar').val();
                var expression = new RegExp(searchField, "i");
                $.getJSON('sample_products.json', function (data){
                    $.each(data, function (key, value){
                        if(value.name.search(expression) != -1 || value.location.search(expression) != -1 )
                        {
                            $('#productTable').append(
                                '<div class="col-5">' + value.name  + '</div>' +
                                '<div class="col-1">' + value.qty   + '</div>' +
                                '<div class="col-2">' + formatMoney(value.price) + '</div>' +
                                '<div class="col-3">' + formatMoney(stotal) + '</div>');
                        }
                    });
                })
    });
            function formatMoney(n){
                return "&euro;" + (n/100).toFixed(2);
            }
        })
    </script>
</body>
</html>